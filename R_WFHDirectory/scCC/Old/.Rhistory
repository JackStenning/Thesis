notch=FALSE)
source("~/Desktop/R_WorkingDirectory/Follow up plots and scripts/Fusion protein RNA.R")
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))    # Rotate x-axis labels for readability
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))    # Rotate x-axis labels for readability
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +  # Keep default whiskers
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (With Whiskers)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))    # Rotate x-axis labels for readability
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))    # Rotate x-axis labels for readability
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (filtered)",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
source("~/Desktop/R_WorkingDirectory/Follow up plots and scripts/Fusion protein RNA.R")
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))    # Rotate x-axis labels for readability
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (filtered)",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
source("~/Desktop/R_WorkingDirectory/Follow up plots and scripts/Fusion protein RNA.R")
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (filtered)",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (filtered)",
x = "Sample Type (Sorted by Median)",
y = "Concentration (ng/µL)") +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for readability
ggplot(Bulk_Seq_filtered, aes(x = reorder(SampleType, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", coef = 1.5) +  # Extend whiskers to 1.5*IQR
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (Whiskers Adjusted)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq_filtered, aes(x = reorder(group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", coef = 1.5) +  # Extend whiskers to 1.5*IQR
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (Whiskers Adjusted)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", coef = 1.5) +  # Extend whiskers to 1.5*IQR
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (Whiskers Adjusted)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
stat_summary(fun.min = min, fun.max = max, geom = "errorbar", width = 0.3, color = "red") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (With Min/Max Whiskers)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
stat_summary(fun.min = min, fun.max = max, geom = "errorbar", width = 0.3, color = "black") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (With Min/Max Whiskers)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
g
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
stat_summary(fun.min = min, fun.max = max, geom = "errorbar", width = 0.3, color = "black") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (With Min/Max Whiskers)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
stat_summary(fun.min = min, fun.max = max, geom = "errorbar", width = 0.3, color = "black") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(Bulk_Seq_filtered, aes(x = reorder(Group, Concentration, FUN = median), y = Concentration)) +
geom_boxplot(fill = "lightblue", color = "darkblue", outlier.shape = NA) +
stat_summary(fun.min = min, fun.max = max, geom = "errorbar", width = 0.3, color = "black") +
geom_jitter(width = 0.2, alpha = 0.5, color = "black") +
labs(title = "RNA Concentration by Sample Type (Without HyPB-ESR1 replicate 4)",
x = "Sample Type",
y = "Concentration (ng/µL)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Center",	"Experiment Insertions",	"Background insertions",	"Reference Insertions",	"pvalue Reference",	"pvalue Background",	"Fraction Experiment",	"TPH Experiment",	"Fraction background",	"TPH background",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_2_GEO_q = read.table("results/1kbp_A_peak_data_ER_WT2.bed_B_Andy_ChIP_q0.05_peaksNP.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_2_Encode2_q = read.table("results/1kbp_A_peak_data_ER_WT2.bed_B_Encode_ER_rep2_ChIP_q0.05_peaksNP.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_4_GEO_q = read.table("results/1kbp_A_peak_data_ER_WT4.bed_B_Andy_ChIP_q0.05_peaksNP.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_4_Encode2_q = read.table("results/1kbp_A_peak_data_ER_WT4.bed_B_Encode_ER_rep2_ChIP_q0.05_peaksNP.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Counting the total reads
ESR1_pyCC_2_total=nrow(ESR1_pyCC_2_GEO_q)
ESR1_pyCC_4_total=nrow(ESR1_pyCC_4_GEO_q)
#Count the number of reads with no overlap
ESR1_pyCC_2_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_2_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_2_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_2_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_4_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_4_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_4_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_4_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
#Determine overlap percentage
Percentage_ESR1_pyCC_2_GEO_q =(1-(ESR1_pyCC_2_GEO_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_2_Encode2_q =(1-(ESR1_pyCC_2_Encode2_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_4_GEO_q =(1-(ESR1_pyCC_4_GEO_q_overlap/ESR1_pyCC_4_total))*100
Percentage_ESR1_pyCC_4_Encode2_q = (1-(ESR1_pyCC_4_Encode2_q_overlap/ESR1_pyCC_4_total))*100
#Create table to plot
#Create table to plot
pyCC_Finalpercentage_table = data.frame(Name=c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode'),
Total=rep(c(ESR1_pyCC_2_total, ESR1_pyCC_2_total, ESR1_pyCC_4_total, ESR1_pyCC_4_total)),
Overlap_withChIP= c(ESR1_pyCC_2_GEO_q_overlap, ESR1_pyCC_2_Encode2_q_overlap, ESR1_pyCC_4_GEO_q_overlap, ESR1_pyCC_4_Encode2_q_overlap),
PercentageOverlapping= c(Percentage_ESR1_pyCC_2_GEO_q, Percentage_ESR1_pyCC_2_Encode2_q, Percentage_ESR1_pyCC_4_GEO_q, Percentage_ESR1_pyCC_4_Encode2_q))
#Then we plot
graphorder= c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode')
pyCC_Figure <- ggplot(data = pyCC_Finalpercentage_table,
aes(x= factor(Name, graphorder),
y = PercentageOverlapping,
fill = Name,
stat("identity"))) +  geom_col(color = "black",
show.legend = FALSE) +  ylim(0, 100) + labs(x = "Name of CC peak file and ChIP Dataset",
y = "% of CC peaks overlapping with ChIP-Seq peak",
title = "pyCalling Cards Peaks and ChIP-Seq Overlap",
subtitle = "Determining percentage of overlapping peaks from pyCalling Card ESR1 peak files with either GSE109820 or \nENCFF063JMY ChIP-Seq datasets within 1 kbp") +  theme_dark() + geom_text(aes(label = round(PercentageOverlapping, 1)), # Add percentage as text
vjust = -0.5, # Adjust vertical position above the bars
size = 4) + coord_cartesian(expand = FALSE, clip = "off") + geom_hline(yintercept = 83, linetype = "dashed")
pyCC_Figure + theme(axis.text.x = element_text(angle = 90))
########################################################################
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Center",	"Experiment Insertions",	"Background insertions",	"Reference Insertions",	"pvalue Reference",	"pvalue Background",	"Fraction Experiment",	"TPH Experiment",	"Fraction background",	"TPH background",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Center",	"Experiment Insertions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"Fraction background",	"TPH background",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"Fraction background",	"TPH background",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"Fraction background",	"TPH background",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_Encode2_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
View(ESR1_pyCC_UMI_GEO_q)
View(ESR1_pyCC_UMI_GEO_q)
View(ESR1_pyCC_UMI_Encode2_q)
View(ESR1_pyCC_full_GEO_q)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_Encode2_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
View(ESR1_pyCC_full_Encode2_q)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("Fullresult/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_Encode2_q = read.table("FullresultUMI/1kbp_A_peak_data_ER_test4.bed_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Counting the total reads
ESR1_pyCC_2_total=nrow(ESR1_pyCC_full_GEO_q)
ESR1_pyCC_4_total=nrow(ESR1_pyCC_UMI_GEO_q)
#Count the number of reads with no overlap
ESR1_pyCC_full_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_full_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_full_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_full_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
#Determine overlap percentage
Percentage_ESR1_pyCC_full_GEO_q =(1-(ESR1_pyCC_full_GEO_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_full_Encode2_q =(1-(ESR1_pyCC_full_Encode2_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_UMI_GEO_q =(1-(ESR1_pyCC_UMI_GEO_q_overlap/ESR1_pyCC_4_total))*100
Percentage_ESR1_pyCC_UMI_Encode2_q = (1-(ESR1_pyCC_UMI_Encode2_q_overlap/ESR1_pyCC_4_total))*100
#Create table to plot
#Create table to plot
pyCC_Finalpercentage_table = data.frame(Name=c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode'),
Total=rep(c(ESR1_pyCC_2_total, ESR1_pyCC_2_total, ESR1_pyCC_4_total, ESR1_pyCC_4_total)),
Overlap_withChIP= c(ESR1_pyCC_full_GEO_q_overlap, ESR1_pyCC_full_Encode2_q_overlap, ESR1_pyCC_UMI_GEO_q_overlap, ESR1_pyCC_UMI_Encode2_q_overlap),
PercentageOverlapping= c(Percentage_ESR1_pyCC_full_GEO_q, Percentage_ESR1_pyCC_full_Encode2_q, Percentage_ESR1_pyCC_UMI_GEO_q, Percentage_ESR1_pyCC_UMI_Encode2_q))
#Then we plot
graphorder= c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode')
pyCC_Figure <- ggplot(data = pyCC_Finalpercentage_table,
aes(x= factor(Name, graphorder),
y = PercentageOverlapping,
fill = Name,
stat("identity"))) +  geom_col(color = "black",
show.legend = FALSE) +  ylim(0, 100) + labs(x = "Name of CC peak file and ChIP Dataset",
y = "% of CC peaks overlapping with ChIP-Seq peak",
title = "pyCalling Cards Peaks and ChIP-Seq Overlap",
subtitle = "Determining percentage of overlapping peaks from pyCalling Card ESR1 peak files with either GSE109820 or \nENCFF063JMY ChIP-Seq datasets within 1 kbp") +  theme_dark() + geom_text(aes(label = round(PercentageOverlapping, 1)), # Add percentage as text
vjust = -0.5, # Adjust vertical position above the bars
size = 4) + coord_cartesian(expand = FALSE, clip = "off") + geom_hline(yintercept = 83, linetype = "dashed")
pyCC_Figure + theme(axis.text.x = element_text(angle = 90))
########################################################################
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy", header = TRUE, sep = "\t", col.names = pyCCcol_names)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Strand", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Strand", "barcode", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_Encode2_q = read.table("result_full/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Counting the total reads
ESR1_pyCC_2_total=nrow(ESR1_pyCC_full_GEO_q)
ESR1_pyCC_4_total=nrow(ESR1_pyCC_UMI_GEO_q)
#Count the number of reads with no overlap
ESR1_pyCC_full_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_full_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_full_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_full_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
#Determine overlap percentage
Percentage_ESR1_pyCC_full_GEO_q =(1-(ESR1_pyCC_full_GEO_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_full_Encode2_q =(1-(ESR1_pyCC_full_Encode2_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_UMI_GEO_q =(1-(ESR1_pyCC_UMI_GEO_q_overlap/ESR1_pyCC_4_total))*100
Percentage_ESR1_pyCC_UMI_Encode2_q = (1-(ESR1_pyCC_UMI_Encode2_q_overlap/ESR1_pyCC_4_total))*100
#Create table to plot
#Create table to plot
pyCC_Finalpercentage_table = data.frame(Name=c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode'),
Total=rep(c(ESR1_pyCC_2_total, ESR1_pyCC_2_total, ESR1_pyCC_4_total, ESR1_pyCC_4_total)),
Overlap_withChIP= c(ESR1_pyCC_full_GEO_q_overlap, ESR1_pyCC_full_Encode2_q_overlap, ESR1_pyCC_UMI_GEO_q_overlap, ESR1_pyCC_UMI_Encode2_q_overlap),
PercentageOverlapping= c(Percentage_ESR1_pyCC_full_GEO_q, Percentage_ESR1_pyCC_full_Encode2_q, Percentage_ESR1_pyCC_UMI_GEO_q, Percentage_ESR1_pyCC_UMI_Encode2_q))
#Then we plot
graphorder= c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode')
pyCC_Figure <- ggplot(data = pyCC_Finalpercentage_table,
aes(x= factor(Name, graphorder),
y = PercentageOverlapping,
fill = Name,
stat("identity"))) +  geom_col(color = "black",
show.legend = FALSE) +  ylim(0, 100) + labs(x = "Name of CC peak file and ChIP Dataset",
y = "% of CC peaks overlapping with ChIP-Seq peak",
title = "pyCalling Cards Peaks and ChIP-Seq Overlap",
subtitle = "Determining percentage of overlapping peaks from pyCalling Card ESR1 peak files with either GSE109820 or \nENCFF063JMY ChIP-Seq datasets within 1 kbp") +  theme_dark() + geom_text(aes(label = round(PercentageOverlapping, 1)), # Add percentage as text
vjust = -0.5, # Adjust vertical position above the bars
size = 4) + coord_cartesian(expand = FALSE, clip = "off") + geom_hline(yintercept = 83, linetype = "dashed")
pyCC_Figure + theme(axis.text.x = element_text(angle = 90))
########################################################################
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Reference Inserions",	"Expected Insertions",	"pvalue",	"Fraction Experiment",	"TPH Experiment",	"TPH background subtracted",	"pvalue_adj Reference", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Strand", "barcode", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("result_trim_minimumUMI/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Strand", "barcode", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("result_trim_minimumUMI/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
############# LOOK HERE ######################
#add or delete the '#' symbol below on install packages
#install.packages("Rtools")
#install.packages("ggthemes")
#DELTE AFTER WRITING
#Load software
library(ggplot2)
library(ggthemes)
#Set working directory
setwd("//userfs/jps558/w2k/Desktop/R_WorkingDirectory/scCC")
#Set column names
pyCCcol_names = c("Chr",	"Start",	"End",	"Experiment Insertions", "Strand", "barcode", "Number of Overlaps with ChIP-Seq Peaks")
##Read data
#Variables named <Window '-a'><Window'-b'>
#Encode Rep 2 was taken as it has more peaks than replicate 1 - even though there is less overlap with my data
ESR1_pyCC_full_GEO_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_full_Encode2_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_final.sorted.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_GEO_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_Andy.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
ESR1_pyCC_UMI_Encode2_q = read.table("result_trim_minimum/1kbp_A_JS_ES1_allpass_adapter_trimmed.tagged.bam_UMIFilt_final.ccf_B_BRD4.bed", header = TRUE, sep = "\t", col.names = pyCCcol_names)
#Counting the total reads
ESR1_pyCC_2_total=nrow(ESR1_pyCC_full_GEO_q)
ESR1_pyCC_4_total=nrow(ESR1_pyCC_UMI_GEO_q)
#Count the number of reads with no overlap
ESR1_pyCC_full_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_full_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_full_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_full_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_GEO_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_GEO_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
ESR1_pyCC_UMI_Encode2_q_overlap = as.numeric(length(which(ESR1_pyCC_UMI_Encode2_q$Number.of.Overlaps.with.ChIP.Seq.Peaks==0)))
#Determine overlap percentage
Percentage_ESR1_pyCC_full_GEO_q =(1-(ESR1_pyCC_full_GEO_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_full_Encode2_q =(1-(ESR1_pyCC_full_Encode2_q_overlap/ESR1_pyCC_2_total))*100
Percentage_ESR1_pyCC_UMI_GEO_q =(1-(ESR1_pyCC_UMI_GEO_q_overlap/ESR1_pyCC_4_total))*100
Percentage_ESR1_pyCC_UMI_Encode2_q = (1-(ESR1_pyCC_UMI_Encode2_q_overlap/ESR1_pyCC_4_total))*100
#Create table to plot
#Create table to plot
pyCC_Finalpercentage_table = data.frame(Name=c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode'),
Total=rep(c(ESR1_pyCC_2_total, ESR1_pyCC_2_total, ESR1_pyCC_4_total, ESR1_pyCC_4_total)),
Overlap_withChIP= c(ESR1_pyCC_full_GEO_q_overlap, ESR1_pyCC_full_Encode2_q_overlap, ESR1_pyCC_UMI_GEO_q_overlap, ESR1_pyCC_UMI_Encode2_q_overlap),
PercentageOverlapping= c(Percentage_ESR1_pyCC_full_GEO_q, Percentage_ESR1_pyCC_full_Encode2_q, Percentage_ESR1_pyCC_UMI_GEO_q, Percentage_ESR1_pyCC_UMI_Encode2_q))
#Then we plot
graphorder= c('Peakset_2_GEO', 'Peakset_2_Encode', 'Peakset_4_GEO', 'Peakset_4_Encode')
pyCC_Figure <- ggplot(data = pyCC_Finalpercentage_table,
aes(x= factor(Name, graphorder),
y = PercentageOverlapping,
fill = Name,
stat("identity"))) +  geom_col(color = "black",
show.legend = FALSE) +  ylim(0, 100) + labs(x = "Name of CC peak file and ChIP Dataset",
y = "% of CC peaks overlapping with ChIP-Seq peak",
title = "pyCalling Cards Peaks and ChIP-Seq Overlap",
subtitle = "Determining percentage of overlapping peaks from pyCalling Card ESR1 peak files with either GSE109820 or \nENCFF063JMY ChIP-Seq datasets within 1 kbp") +  theme_dark() + geom_text(aes(label = round(PercentageOverlapping, 1)), # Add percentage as text
vjust = -0.5, # Adjust vertical position above the bars
size = 4) + coord_cartesian(expand = FALSE, clip = "off") + geom_hline(yintercept = 83, linetype = "dashed")
pyCC_Figure + theme(axis.text.x = element_text(angle = 90))
########################################################################
library(karyoploteR)
install.packages(karyoploteR)
install.packages(karyoploteR)
#check install
install.packages("BiocManager")
BiocManager::install("karyoploteR")
BiocManager::install("karyoploteR")
#Load libraries
library(karyoploteR)
