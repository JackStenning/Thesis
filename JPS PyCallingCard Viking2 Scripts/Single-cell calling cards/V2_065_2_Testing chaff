
cutadapt \
  -g "$FORWARD...$REVERSE_bc;min_overlap=33" \
  --no-indels \
  --rc \
  --times=3 \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o 3rc_extracted_bc.fastq \
  "$INPUT"


cutadapt \
  -g "$FORWARD...$REVERSE_bc;min_overlap=33" \
  --no-indels \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o norc_extracted_bc.fastq \
  "$INPUT"


seqtk seq -r rc_extracted_bc.fastq > extracted_revcomp_rc.fastq

cat norc_extracted_bc.fastq extracted_revcomp_rc.fastq > allextracted.fastq

seqkit rmdup allextracted.fastq > all_extracted_deduped.fastq





#Below is 17/07 that didnt work

cutadapt \
  -g "$FORWARD;min_overlap=33" \
  -a "$REVERSE_nobc;min_overlap=26" \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o matched_nobc.fastq \
  "$INPUT"

cutadapt \
  -g "$FORWARD;min_overlap=33" \
  -a "$REVERSE_bc;min_overlap=37" \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o matched_bc.fastq \
  "$INPUT"

#Extract regions between primers

cutadapt \
  -g "$FORWARD...$REVERSE_nobc;min_overlap=26" \
  --no-indels \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o norc_extracted_nobc.fastq \
  "$INPUT"

cutadapt \
  -g "$FORWARD...$REVERSE_bc;min_overlap=33" \
  --no-indels \
  -e 0 \
  --debug \
  --action=none \
  --discard-untrimmed \
  -o norc_extracted_bc.fastq \
  "$INPUT"


#below is 11/07

#Load module
module load cutadapt/4.2
module load SeqKit/2.3.1
z

## No concatenations
cutadapt \
  -g "$FORWARD...$REVERSE_nobc" \
  --no-indels \
  --revcomp \
  -e 0 \
  --discard-untrimmed \
  --action=retain \
  -o nocat_extracted_nobc.fastq \
  "$INPUT" 

cutadapt \
  -g "$FORWARD...$REVERSE_bc" \
  --no-indels \
  --revcomp \
  -e 0 \
  --discard-untrimmed \
  --action=retain \
  -o nocat_extracted_nobc.fastq \
  "$INPUT" 

#Error rate 1

cutadapt \
  -g "${FORWARD}...${REVERSE_nobc}" \
  --no-indels \
  --rc \
  -e 1 \
  --times=3 \
  --discard-untrimmed \
  -o "$ROUGH" \
  $INPUT

cutadapt \
  -g "${FORWARD}" \
  -a "${REVERSE_nobc}" \
  --no-indels \
  --rc \
  -e 1 \
  --discard-untrimmed \
  --action=retain \
  -o "$OUTPUT_1" \
  "$ROUGH" 

cutadapt \
  -g "${FORWARD}...${REVERSE_bc}" \
  --no-indels \
  --rc \
  -e 1 \
  --times=3 \
  --discard-untrimmed \
  -o "$ROUGH" \
  $INPUT

cutadapt \
  -g "${FORWARD}" \
  -a "${REVERSE_bc}" \
  --no-indels \
  --rc \
  -e 1 \
  --discard-untrimmed \
  --action=retain \
  -o "$OUTPUT_2" \
  "$ROUGH" 

##Another version
module purge

module load cutadapt/3.5 



####################################################


#below is 02/07

cutadapt \
  -g "${FORWARD}...${REVERSE_nobc}" \
  --no-indels \
  --rc \
  -e 0 \
  --times=3 \
  --discard-untrimmed \
  -o "$ROUGH" \
  $INPUT

cutadapt \
  -g "${FORWARD}" \
  -a "${REVERSE_nobc}" \
  --no-indels \
  --rc \
  -e 0 \
  --discard-untrimmed \
  --action=retain \
  -o "$OUTPUT_1" \
  "$ROUGH" 

cutadapt \
  -g "${FORWARD}...${REVERSE_bc}" \
  --no-indels \
  --rc \
  -e 0 \
  --times=3 \
  --discard-untrimmed \
  -o "$ROUGH" \
  $INPUT

cutadapt \
  -g "${FORWARD}" \
  -a "${REVERSE_bc}" \
  --no-indels \
  --rc \
  -e 0 \
  --discard-untrimmed \
  --action=retain \
  -o "$OUTPUT_2" \
  "$ROUGH" 


##### TEST


#Go back to script directory
cd /mnt/scratch/users/jps558/Stenning_Data_Analysis






#Old

cd /mnt/scratch/users/jps558/Stenning_Data_Analysis/2024-JS-ssCC/CallingCards_ONT/E1_barcode22

INPUT="E1_barcode22_cat.fastq"
OUTPUT="subset.fastq"

# Define known sequences to search for (exact matches)
SEQS=(
    "TACACTCTTTCCCTACACGACGCTCTTCCGATCTACTTAGGGTGGTCTATATGTATTCCGTTTTTTTTTTTTTTTTTTTTTTTTTTTTTAAGAGATGGTGTCTTGCTCTGTTGCCCAGGCTGGAGTGCAGTGGCACGATCTCAGGTCACTGCAACGTCTGCCTTCCGGGTTCAAGTGACTCTCCTGCCTGTTTCCCGAGAAGCTGAGATTACAGGCATACGCCACCACGCCTGGCTAATTTTTGTATTTTTAGTAGAGATAGGGTTTCACCATGCTGGCCAGGCTGGTCTTGAACTCCTGACCTCAAGTGATCCTGTCTTGGCCTCCCAAAAGGCTGGGATGACAGGCGTGAGCCACTGTGCCTGGCCTCAGTCTTTCATTGGGAATGCCCAGCATGGTGGCTCACACCTGTCATCCCAGCACTTTGGGAGACCGAGGCAGGCGGATCACCTCAGGTCAGGAGTTCGAGACCAGCCTGACCAACATGGCCAAACCCCGTCTCTACTAAAAATACAAAAACTAGCCTGGTGTGGTGGTGGGCGCCTGGAATCCCAACTACTCCAGAGGCTGAGGCAGGACAATCGCTTGAACCTGGGAGGCGGAAGTGGCAGTGAGCCGAGATTGTACCATTGCACTCTAGCCTGGGCGACGGAGCAAGACTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCCTGACTGAGATCTGGCTACCACGGTCAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGCAATACATTTTGCATCTACTTGACGGCGTCTTGCTACACTCTTCCTACACGAGCTCTTCCGATCTTGTGTGAGTTATCCAGTGCGAGATTACTTTTTTTTTTTTTTTTTTTTTTTTTCGATAGGTCTCGATCCATTGCTGAGGTTGGAGTGCAGTGGTGCATTCATGGTTCACTGCAGCCTTGACCTCCCAGGCTCAAGCAATCCTACCACCTCAGCCTCTCAGGTAGCAAGGACAACAGGTGTGTACCACCACACCCAGCGAATTTTGGTATTTTTTGTAGAGATGGGGTTTTGCCATGTTGCCCAGGCTCGTCTTGAACTCCTGGGGTCAAGCAACCCACCCACCTCGACCTCCCAAAGTGCTGGGATTATAAGCATGAGCCACTACACTCGGCCTGTACTTCTAGTTTATAAATAAAAATCTCAAGTTCGGTGCATTTGAAAAAAAATCATTTCTATAATAACCAATTATGAAAGACTCATATGTATCCTGTTTTCCTGGAGACATAATAGTATGACATTATAAATAATTGTTATAGAAATGTCATCAACATAAATTTCAAGGAAGAAATATATTGAAGAGCTTCAGCTTTCATACAAATATAAATATGAGAGGCAGAAAAACAAACTGCAACATATGAACAGTCTTAAATAGAATTTGTTTCTATAGGGACTTAAACTGTAAGTTATAAACACAGAAGGGTAGATTCCATTCGGGGAAGATGGCAGAGAGCAGGCAGGACTAACTTGCGGCTCCCACTTGGACAAACAGAGCAGCGTGTAGAGATCCACATGGTGAACTTTTGCTCCAAGAACTACTGCAGGAACATACCAGGAAAGCCAGAGAATCCACAGACACTTTGAAGGAGGTGGATTGCAGCTACAGGCTCTGTGGGAAAGCTGAGGAACTCCAGAGACAAAGGACATAATTGCTTGGGAGCTTTATGGCCCTGCCCACTGCCTGAGATGCTGGTGCGGTTGCAAAGAAGGGGAATACTTATACCCTGCTGGTGGGAATGTAAATTAGCTCAGCCACTGTGGAAACTAAATGAAGTTTCTCAAAGAACTTAAAAGAGAACTATTGTTTGACCCAGCAATCCCTCTATTGGGTATATACCTAAAGGAAAATAAATCATTCTAACCAAAAGGACACAAGCACACGTGTTCATCACAGCACTGTTCACAACAGCATAGACACGGAACCAACCTAAATGTCCATCAGTGGTAGACTGGATAAAGAAAATGTGGTAGATAGACACCATGGAATACTACACAGTCACAGAAAAATGAATGGGAGTTTTGGATGCTTTATTATCTAGTTCTGAGTCACTTGTTTATGCAGCATAAGTAAAAACAAGCGTTTACCTCAGCTTAAATCTGCAAAAGCTTAAGGAAGGGTTGCAAGAAATTCAAATCCACTATCTCATTCACAGCACGAGCAGATTTAATTTCAGTAGACAAGATATAAATTAACCCCAAAAAGATAGTCTGCGTAAAATTGACGC"
    "TGCTACACTCTTTCCCTACACGACGCTCTTCCGATCTCAGCCAGCATGCGGTCAGCACGGGGGAGTTTTTTTTTTTTTTTTTTTTTTTCCATTAATCACATTTTTATTTTTTATGCTTCTGACCTTTTCAATCTCCTTAGCACATATTCAAAACTCTCTGAACATAGTAGGTGCTCAGTAAAATCTTGTCAATAAGAAGCCAGGATCTATAGCTACTTTTCTCTCTCCCTGCTAAACTAATGACAGAAAGCAGTACCAAGCATAGTGTGCGTAGCACACCTTAGTCATCCAATAAATGATAATTACTCTAGTTTCTCTTCATATCGCATAAATCTTTCACCTTTTACCAATAAATGATAATTCCTTTCTTTCATTTTCTAAGCAACTTTATCTATATAACAGTTTATAGCTATGGACTCAGGACTAATATTGGCTTCCACCTTAGTGGTGCATATAAAAAGAGTCCTTGGTCAGATACTTTATATATACATCAGATTTATAACTTCCTGACTTATAGAATATTAGAATAAGAAGAGAATATGAAAGATCATTTGGTCCAATGTCCTCACTGTATAGGTGCTTATATCTTGATCTAATTAGCCCATTTTTCTTA"
    "CTTTCCCTACACGACGCTCTTCCGATCTGAGTGTTGTATCGTACCCTGATGCGTCCTTTTTTTTTTTTTTTTTTTTTTTGGTTTAGTAAGTCTTTTAATTACTCCGTCATGAGATAAACAGTGGACCATCCAAATAGTACAAAACATCTTCATAGTCACCTCTGATAGTTTGTAGAAAGGTCCACAGGTTTTCTGACGGGCTTCTCATTCACAGAATTTACATCTCCTCCCCTTAAC"
    "TCCATTAATCACATTTTTATTTTTTATGCTTCTGACCTTTTCAATCTCCTTAGCACATATTCAAAACTCTCTGAACATAGTAGGTGCTCAGTAAAATCTTGTCAATAAGAAGCCAGGATCTATAGCTACTTTTCTCTCTCCCTGCTAAACTAATGACAGAAAGCAGTACCAAGCATAGTGTGCGTAGCACACCTTAGTCATCCAATAAATGATAATTACTCTAGTTTCTCTTCATATCGCATAAATCTTTCACCTTTTACCAATAAATGATAATTCCTTTCTTTCATTTTCTAAGCAACTTTATCTATATAACAGTTTATAGCTATGGACTCAGGACTAATATTGGCTTCCACCTTAGTGGTGCATATAAAAAGAGTCCTTGGTCAGATACTTTATATATACATCAGATTTATAACTTCCTGACTTATAGAATATTAGAATAAGAAGAGAATATGAAAGATCATTTGGTCCAATGTCCTCACTGTATAGGTGCTTATATCTTGATCTAATTAGCCCATTTTTCTTAA"
    "TCTTCTTTCCCTACACGACGCTCTTCCGATCTTCTACATCAGGCCCTAGAGTCACAGATATTTTTTTTTTTTTTTTTTTTTTTAAATTCAATCTGGAATCAGAAAGCGGTGGATTCTGGCAAATGGTCCTTGTGCCCTCCCCACTCATCCCTGGTCTGGTCCCCTGTTGCCCATAGCCCTTTACCCTGAGCACCACCCCAACAGACTGGGGACCAGCCCCCTCGCCTGCCTGTGTCTCTCCCCAAACCCCTTTAGATGGGGAGGGAGAAAGGAGGGGAGAGGGGAGGGGACCTGCCCCTCCTCAGGCATCTGGGAGGGCCCTGCCCCCATGGGCTTTACCCTTCCCTGCGGGCTCTCTCCCCGACACATTTGTTAAAATCAAACCTCAATAAACTACAGTTTAATATGGAAAAAAAAAAAAAAAAAAACACGCCTGGCACTCACTCCCGAGACTGAGAGATCGGAAGAAGCATCCATGGTTTTGTCCTCTTCTTTGGTTCAGTTACTAGTATTGCTACACTCTTTCCCTACACGACGCTCTTCCGATCTGTGCACGCAGAGGGTTCTATTCAGTAGTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTATAGTCTTCATGTTGGCTTTTATTTGGGGCAGGAAAAAGAAACAAGAAAAACAAAACTCCCACTTAATTTTTCCCTAATTATTATTTCCAGATGAATTTATCTTCTGAATAAAGGAATTTATTGTCTCAATTTCCTGTCTTACTGGGCATTATGTTGAATTTCACTGACTCTTTTCTTATGTCACTCTCCTAGCTATTTATTTTGTTTAGACACAATACTCTGAACAAACCTAAATCTGACGTTTAGAAGCAAGAATACAATTTTTGGGGGGAAATTAGAGTTACTAATTTAACTGGGTCATAGAGATGTATTATTACTGTGATTTCTAAAGAAGATTATGTTTTCTTTGAATTGTGCTCTTTTCAGATTTTGAGATTTTTAATAATTCACTGGAAGTGTGACATAGATGTATCAAAGGGAGCATTGCTAGAAGGGCAGCTAGTGATTTCCATAGAAGGATTAAATTCTAAGCACCAGGCAAATGCTCTTCATTGTGTAACAACTAGTAAGTAGAGAAAGAAAAAATATTTTCTATCTCTTTTGTCATGGTTTATGTCGTAGCTTATTTAAAAATTTCAATTAGAATCTTTTATCATGTTATTCCAGGATTGTTCCATAATTATAAAATGAAATGATTATGTAATAAGTGTCTGGTGGTAGATTTACAAATGTATCATACAGGAAAGGTGAGTAGTTGAATGACTCTTACCATAGATTATTTATTTTACTGGTTTAAGTAAAAATTGCTCAGAAACAATCTTATTTTTCTCTTGATTTTAATCTACTTTGTCACAGCTAAATTATATTACATTGAGCTTTACCTACTTTTTTTTTCCCAAGTCTAAATTTTGGCAGTAGCAAAAAAAAAAAAAAAAAAAAAAGGAAAAATAATGAATGGTGCATACTGTGATTAGTTTGAAAATATCTCTTCCATTTGGCTTTCATGCTTTTATCATTTTTGCCTGTTGTCTTTGAGGGAAACCTGATGCAGTGAGTGGCTCTGAAGCATGAATTTTCTTAAACTTGAAGTGTTAGCTTTTTGTGTGTGTGTGTGGTGTGTGTGTGTGTAGGTTTATTGAAGGGTACTTTGGATTGAAGTTGCCCCTTCAGGCTTAGAGAAGTCACTTGGGCACCAAGTTGAGATTGGATAGTGAACTAGGCTTTACAAGACATTTGCTTACCTGAACAGGAATGACCTGTCTTGTCTTTGTGTATTAACCCTGAAAAGATAGTCTGCGTAAAATTGACGC"
    "TACACTCTTTCCCTACACGACGCTCTTCCGATCTGAGTGTTGTATCGTACCCTGATGCGTCCTTTTTTTTTTTTTTTTTTTTTTTGGTTTAGTAAGTCTTTTAATTACTCCGTCATGAGATAAACAGTGGACCATCCAAATAGTACAAAACATCTTCATAGTCACCTCTGATAGTTTGTAGAAAGGTCCACAGGTTTTCTGACGGGCTTCTCATTCACAGAATTTACATCTCCTCCCCTTAACCCTGAAAAGATAGTCTGCGTAAAATTGACGC"
    "TACACTCTTTCCCTACACGACGCTCTTCCGATCTGCGGAAATCGATGGAGAGTCATACTTCTTTTTTTTTTTTTTTTTTTTTTTTTTCCTTTTATTAATTAATGAGTTAATTGACACATGTTCGTTTTATGTTTGTATATTTGCATAGATTCTGATTTTACCTTTTAGAAATAATCTTTAACGTTGGAATGGGTTAGGAATGAATGGGAAATGAGTAGAGGCAACACATGTATACAACTCTTTTTAACCTTGGAAAGATAGTCTGCGTAAAATTGACGCAACACTCTTTCCCTACACGACGCTCTTCCGATCTTCCACCACAGCGTGCTCACGTAAGTGGCTTTTTTTTTTTTTTTTTTAAGCTTATCAGCTGTCATTAGTGTTAGTATATTTTACGTGTGGCCAAAGACATTACTTCTTCTAATGGGGCCCCAGGGAAGCCAAAAGATTGGACACCCCTGTATTAGGCATTAATGCTCCCATCGTCAATATTTTTAAAAACAGAATTGTCAATGTATAACTCTGTCTCAACCAGCCTTTCTGTTTGTTTGCTGTTCTTTTGACTTTCAAGGATATGGATATAGATGAAGGGCAAGATGGAGTGGAAGAGGAGGTCTTTGAACAAGAAGCTAAGAAAGTGGCGGTTCGCTCAAGATCAAGAACACATTCACGATCTCGTTCAAGGTTCTACAATGATATTTAATAATAGCCGTGTGTGAACTTTAAAATGTTGGCTTATTTCTTTGCATCAGGATGAAAGGAAATGTTTCCTTGGGATGACATATTTTTCTCAGTCTCTCGGAAAAAAAGTTATTCCAAAAACAAGATAACCTTTGTTCTGTTTTAATTGGTATATCTGTGGCTATTTATTTCAGTAATTTACATAGATTGGCAGCCATATCATGAGACAGGGATTTTGAATTATATTTTATTTTAGTTAATATTATGATGACACCCAATTTAGAATATTGTTGCCCCTGAACAACAGTTAAGTCAGGCCATATTTCCTGGATTCCACTCATCTCACAGTGATACCAAAAATGGTTATAAAAATGAAACTACAAAATTTATTTTTATAAACATTAACTGTAATACCAAACCGTTAGGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGTCATACCAAGGCAGTCCTACTTCAGGTAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGCGTCAATTTTACGCAGACTATCTTTCCAAGGTTAAAAAGAGTTGTATACATGTGTTGCCTCTACTCATTTCCCATTCATTCCTCAACCCATTCCAACGTTAAAGATTATTTCTAAAAGGTAAAATCAGAATCTATGCAAATATACAAACATAAAACGAACATGTGTCAATTAACTCATTAATTAATAAAGGAAAAAAAAAAAAAAAAAAAAAAAAAGAAGTATGACTCTCCACTCGATTTCCGCAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGCAATACGTAAC"
)

nano known_seq.txt

awk -v sequences="$(IFS=,; echo "${SEQS[*]}")" '
BEGIN {
    n = split(sequences, seq_list, ",");
    for (i = 1; i <= n; i++) {
        exact[seq_list[i]] = 1;
    }
}
{
    line[NR%4] = $0
    if (NR%4 == 0) {
        if (exact[line[2]]) {
            print line[1] "\n" line[2] "\n" line[3] "\n" line[0]
        }
    }
}
' "$INPUT" > "$OUTPUT"
